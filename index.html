<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <title>éå¹´åˆ®åˆ®æ¨‚æˆ°ç¸¾èª¿æŸ¥ Â· é¦¬å¹´è²¡é‹å¤§é»å</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --bg-top: #fee2e2;
      --bg-mid: #f97316;
      --bg-bottom: #7f1d1d;
      --panel: #fff7ed;
      --border: #fed7aa;
      --accent: #f97316;
      --accent-strong: #ea580c;
      --accent-soft: rgba(248, 113, 113, 0.15);
      --text: #3f1d1d;
      --muted: #9f1239;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background:
        radial-gradient(circle at top, var(--bg-top) 0, var(--bg-mid) 45%, var(--bg-bottom) 90%);
      color: var(--text);
      font-size: 17px;
    }
    .wrap {
      max-width: 960px;
      margin: 0 auto;
      padding: 20px 16px 40px;
    }
    header {
      text-align: center;
      margin-bottom: 16px;
      color: #fef2f2;
    }
    h1 {
      margin: 0 0 6px;
      font-size: 30px;
    }
    .subtitle {
      font-size: 16px;
      opacity: 0.95;
    }

    .lantern-row {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 12px;
      margin: 10px 0 12px;
      color: #fef2f2;
      font-size: 14px;
    }
    .lantern {
      padding: 4px 12px;
      border-radius: 999px;
      border: 1px solid rgba(254, 226, 226, 0.9);
      background: rgba(248, 250, 252, 0.15);
    }

    .warning {
      margin: 0 auto 16px;
      max-width: 680px;
      font-size: 14px;
      color: #b91c1c;
      background: #fee2e2;
      border: 1px solid #fecaca;
      padding: 8px 12px;
      border-radius: 10px;
    }

    .layout {
      display: grid;
      gap: 18px;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, .8fr);
    }
    @media (max-width: 840px) {
      .layout { grid-template-columns: 1fr; }
    }

    .card {
      background: var(--panel);
      border-radius: 16px;
      border: 1px solid var(--border);
      padding: 18px 20px 20px;
      box-shadow: 0 16px 34px rgba(127, 29, 29, 0.35);
    }
    .card h2 {
      margin: 0 0 12px;
      font-size: 22px;
    }

    .progress-shell { margin-bottom: 14px; }
    .progress-track {
      width: 100%;
      height: 10px;
      border-radius: 999px;
      background: #fee2e2;
      overflow: hidden;
    }
    .progress-bar {
      height: 100%;
      width: 0;
      border-radius: inherit;
      background: linear-gradient(90deg, #fb923c, #facc15);
      transition: width 0.35s ease-out;
    }

    label {
      display: block;
      margin: 14px 0 6px;
      font-size: 17px;
    }
    select, input[type="number"], input[type="text"] {
      width: 100%;
      padding: 12px 13px;
      border-radius: 12px;
      border: 1px solid #fed7aa;
      background: #fff7f7;
      color: var(--text);
      font-size: 16px;
      transition: box-shadow 0.2s ease, transform 0.08s ease;
    }
    select:focus, input:focus {
      outline: none;
      box-shadow: 0 0 0 2px rgba(251, 146, 60, 0.7);
      transform: translateY(-1px);
    }

    .checkbox-group {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
      gap: 8px 14px;
      margin-top: 6px;
    }
    .checkbox-group label {
      margin: 0;
      font-size: 15px;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .checkbox-group input { margin-right: 2px; }

    .hint {
      font-size: 14px;
      color: var(--muted);
    }

    button {
      margin-top: 20px;
      width: 100%;
      padding: 13px 16px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(90deg, #f97316, #facc15);
      color: #450a0a;
      font-weight: 800;
      font-size: 17px;
      cursor: pointer;
      box-shadow: 0 10px 22px rgba(248, 250, 252, 0.25);
      transition: transform 0.09s ease, box-shadow 0.09s ease;
    }
    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 28px rgba(248, 250, 252, 0.35);
    }
    button:active {
      transform: translateY(0);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
    }
    button:disabled {
      opacity: .6;
      cursor: wait;
    }

    .result-title {
      font-size: 22px;
      margin-bottom: 8px;
      font-weight: 800;
    }
    .result-main {
      font-size: 18px;
      margin-bottom: 8px;
    }
    .result-detail {
      font-size: 15px;
      color: var(--muted);
      margin-bottom: 6px;
    }
    .result-banner {
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 12px;
      background: var(--accent-soft);
      border: 1px solid rgba(248,113,113,.5);
      font-size: 16px;
    }

    .footer-note {
      margin-top: 10px;
      font-size: 13px;
      color: var(--muted);
    }

    .step { display: none; }
    .step.active { display: block; animation: fadeIn 0.25s ease-out; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(4px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>ğŸ§§ğŸ´ éå¹´åˆ®åˆ®æ¨‚æˆ°ç¸¾èª¿æŸ¥</h1>
    <div class="subtitle">é¦¬å¹´è²¡é‹å¤§é»åï¼šçœ‹çœ‹ä½ æ˜¯è²¡ç¥ã€è´ŠåŠ©å•†ï¼Œé‚„æ˜¯å‚³èªªä¸­çš„ã€Œå›æœ¬ä»”ã€ï¼Ÿ</div>
    <div class="lantern-row">
      <div class="lantern">ç¦</div>
      <div class="lantern">é¦¬å¹´è¡Œå¤§é‹</div>
      <div class="lantern">åˆ®å‡ºå¥½æ‰‹æ°£</div>
      <div class="lantern">æ­å–œç™¼è²¡</div>
    </div>
  </header>

  <div class="warning">âš ï¸ å°ç£æ³•è¦ï¼šæœªæ»¿ 18 æ­²ä¸å¾—è³¼è²·æˆ–å…Œé ˜å½©åˆ¸ï¼ˆåŒ…æ‹¬åˆ®åˆ®æ¨‚ï¼‰ã€‚æœ¬å•å·åƒ…ä¾›æ»¿ 18 æ­²ä»¥ä¸Šæ°‘çœ¾åˆ†äº«ç¶“é©—ã€‚</div>

  <div class="layout" id="survey-section">
    <section class="card">
      <h2>å¡«å¯«ä½ çš„éå¹´åˆ®åˆ®æ¨‚æˆ°å ±</h2>
      <div class="progress-shell">
        <div class="progress-track"><div class="progress-bar" id="progress-bar"></div></div>
      </div>
      <form id="survey-form">
        <!-- Step 1: Age -->
        <div class="step active" data-step="1">
          <label for="age">ä½ å¹¾æ­²ï¼Ÿ</label>
          <select id="age" name="age" required>
            <option value="" disabled selected>è«‹é¸æ“‡å¹´é½¡å€é–“ï¼ˆåƒ…é™ 18 æ­²ä»¥ä¸Šï¼‰</option>
            <option>18â€“24 æ­²</option>
            <option>25â€“34 æ­²</option>
            <option>35â€“44 æ­²</option>
            <option>45â€“54 æ­²</option>
            <option>55â€“64 æ­²</option>
            <option>65 æ­²ä»¥ä¸Š</option>
          </select>
          <div class="hint">æé†’ï¼šæœªæ»¿ 18 æ­²ä¸å¾—è³¼è²·å½©åˆ¸ã€‚æœ¬å•å·åƒ…ä¾›æˆå¹´å¾Œçš„å°è³­å¿ƒå¾—åˆ†äº«ã€‚</div>
          <button type="button" data-next>ä¸‹ä¸€é¡Œ</button>
        </div>

        <!-- Step 2: City -->
        <div class="step" data-step="2">
          <label for="city">åœ¨å“ªè£¡éå¹´ï¼Ÿ</label>
          <select id="city" name="city" required>
            <option value="" disabled selected>è«‹é¸æ“‡ç¸£å¸‚</option>
            <option>å°åŒ—å¸‚</option><option>æ–°åŒ—å¸‚</option><option>åŸºéš†å¸‚</option>
            <option>æ¡ƒåœ’å¸‚</option><option>æ–°ç«¹å¸‚</option><option>æ–°ç«¹ç¸£</option>
            <option>è‹—æ —ç¸£</option><option>å°ä¸­å¸‚</option><option>å½°åŒ–ç¸£</option>
            <option>å—æŠ•ç¸£</option><option>é›²æ—ç¸£</option><option>å˜‰ç¾©å¸‚</option><option>å˜‰ç¾©ç¸£</option>
            <option>å°å—å¸‚</option><option>é«˜é›„å¸‚</option><option>å±æ±ç¸£</option>
            <option>å®œè˜­ç¸£</option><option>èŠ±è“®ç¸£</option><option>å°æ±ç¸£</option>
            <option>æ¾æ¹–ç¸£</option><option>é‡‘é–€ç¸£</option><option>é€£æ±Ÿç¸£</option>
          </select>
          <button type="button" data-next>ä¸‹ä¸€é¡Œ</button>
        </div>

        <!-- Step 3: Scratch games -->
        <div class="step" data-step="3">
          <label>ä½ ä»Šå¹´éƒ½è²·äº†å“ªäº›åˆ®åˆ®æ¨‚ï¼Ÿï¼ˆå¯è¤‡é¸ï¼‰</label>
          <div class="checkbox-group">
            <label><input type="checkbox" name="types" value="é¦¬å¹´è¡Œå¤§é‹ï¼ˆ100 å…ƒï¼‰">é¦¬å¹´è¡Œå¤§é‹ï¼ˆ100 å…ƒï¼‰</label>
            <label><input type="checkbox" name="types" value="å¤§ä¸‰å…ƒï¼ˆ200 å…ƒï¼‰">å¤§ä¸‰å…ƒï¼ˆ200 å…ƒï¼‰</label>
            <label><input type="checkbox" name="types" value="æµ·åº•å¤§å°‹å¯¶ï¼ˆ300 å…ƒï¼‰">æµ·åº•å¤§å°‹å¯¶ï¼ˆ300 å…ƒï¼‰</label>
            <label><input type="checkbox" name="types" value="äº”è·¯è²¡ç¥ï¼ˆ500 å…ƒï¼‰">äº”è·¯è²¡ç¥ï¼ˆ500 å…ƒï¼‰</label>
            <label><input type="checkbox" name="types" value="é‡‘é¦¬çï¼ˆ500 å…ƒï¼‰">é‡‘é¦¬çï¼ˆ500 å…ƒï¼Œ100% ä¸­çç‡ï¼‰</label>
            <label><input type="checkbox" name="types" value="è²¡ç¥å ±åˆ°ï¼ˆå¤šé¢é¡ï¼‰">è²¡ç¥å ±åˆ°ï¼ˆå¤šé¢é¡ç³»åˆ—ï¼‰</label>
            <label><input type="checkbox" name="types" value="1200 è¬å¤§å‰åˆ©ï¼ˆ1000 å…ƒï¼‰">1200 è¬å¤§å‰åˆ©ï¼ˆ1000 å…ƒï¼‰</label>
            <label><input type="checkbox" name="types" value="2000 è¬è¶…ç´šç´…åŒ…ï¼ˆ2000 å…ƒï¼‰">2000 è¬è¶…ç´šç´…åŒ…ï¼ˆ2000 å…ƒï¼‰</label>
            <label><input type="checkbox" name="types" value="å…¶ä»–">å…¶ä»– / ä¸Šé¢æ²’åˆ—åˆ°çš„æ¬¾å¼</label>
          </div>
          <div class="hint">å“ååƒè€ƒè¿‘æœŸå°å½©é¦¬å¹´åˆ®åˆ®æ¨‚ï¼ˆå¯¦éš›è³¼è²·è‹¥ä¸åŒä¹Ÿæ²’é—œä¿‚ï¼Œå‹¾å¤§è‡´ç³»åˆ—å³å¯ï¼‰ã€‚</div>
          <button type="button" data-next>ä¸‹ä¸€é¡Œ</button>
        </div>

        <!-- Step 4: Spent -->
        <div class="step" data-step="4">
          <label for="spent">ç¸½å…±è²·äº†å¤šå°‘éŒ¢çš„åˆ®åˆ®æ¨‚ï¼Ÿï¼ˆå…ƒï¼‰</label>
          <input id="spent" name="spent" type="number" inputmode="decimal" min="0" step="1" required>
          <div class="hint">å¯ä»¥å¡« 0ï¼Œä»£è¡¨åªæ˜¯å¹«å®¶äººåˆ®ã€è‡ªå·±æ²’èŠ±éŒ¢ã€‚</div>
          <button type="button" data-next>ä¸‹ä¸€é¡Œ</button>
        </div>

        <!-- Step 5: Won -->
        <div class="step" data-step="5">
          <label for="won">æœ€å¾Œè´äº†å¤šå°‘éŒ¢ï¼Ÿï¼ˆå¯å¡« 0 æˆ–è² å€¼ï¼Œè² ä»£è¡¨è³ éŒ¢ï¼‰</label>
          <input id="won" name="won" type="number" inputmode="decimal" step="1" required>
          <div class="hint">ä¾‹å¦‚ï¼šè´ 5000 å°±å¡« 5000ï¼›æ•´é«”å°è³  800 å°±å¡« -800ï¼›å®Œå…¨æ²’è¼¸æ²’è´å°±å¡« 0ã€‚</div>

          <button type="submit">é€å‡ºæˆ°å ±</button>
        </div>
      </form>
      <div class="footer-note">è³‡æ–™åƒ…ç”¨æ–¼çµ±è¨ˆèˆ‡ç”¢ç”Ÿç¾¤é«”æˆ°ç¸¾ï¼Œæ²’æœ‰æ”¶é›†è¯çµ¡æ–¹å¼ã€‚</div>
    </section>

    <section class="card" id="result-card">
      <div class="result-title">ç­‰ä½ é€å‡ºè¡¨å–®ï¼Œæˆ‘å¹«ä½ çœ‹é€™æ¬¡æœ‰æ²’æœ‰ã€Œé¦¬ä¸Šç™¼ã€ã€‚</div>
      <div class="result-detail">å®Œæˆå¾Œæœƒé¡¯ç¤ºï¼šé€™æ¬¡éå¹´åˆ®åˆ®æ¨‚çš„æŠ•å ±ç‡ã€è³ºè³ é‡‘é¡ï¼Œä»¥åŠå¤§ç´„è´éå¤šå°‘æ¯”ä¾‹çš„å…¶ä»–äººã€‚</div>
      <div class="result-banner">å¡«å®Œä¸ç”¨ 1 åˆ†é˜ï¼Œå°±èƒ½çŸ¥é“ä½ åœ¨è¦ªå‹ä¹‹é–“ç®—æ˜¯åã€Œè²¡ç¥ã€é‚„æ˜¯åã€Œè´ŠåŠ©å•†ã€ã€‚</div>
    </section>
  </div>
</div>

<script>
  const SHEET_ENDPOINT = "https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec";

  const form = document.getElementById("survey-form");
  const resultCard = document.getElementById("result-card");
  const progressBar = document.getElementById("progress-bar");
  const steps = Array.from(document.querySelectorAll(".step"));
  const surveySection = document.getElementById("survey-section");

  const TITLES = [
    "é¦¬å¹´é«˜å€è²¡ç¥",
    "ç©©å¥å›æœ¬ä»”",
    "ç†±è¡€è´ŠåŠ©å•†",
    "å†·éœç†è²¡é¦¬",
    "åˆ®åˆ°æ‰‹é…¸ä½†é‚„ç¬‘å¾—å‡ºä¾†å‹"
  ];

  function showStep(n) {
    steps.forEach((step, idx) => {
      step.classList.toggle("active", idx === n - 1);
    });
    const percent = (n - 1) / steps.length * 100;
    progressBar.style.width = `${percent}%`;
  }

  // æŒ‰ã€Œä¸‹ä¸€é¡Œã€åˆ‡æ›æ­¥é©Ÿ
  steps.forEach((step, idx) => {
    const nextBtn = step.querySelector("[data-next]");
    if (!nextBtn) return;
    nextBtn.addEventListener("click", () => {
      const inputs = step.querySelectorAll("select, input[required]");
      for (const input of inputs) {
        if (!input.value) {
          input.reportValidity();
          return;
        }
      }
      // ç‰¹åˆ¥æª¢æŸ¥ç¬¬ 3 é¡Œè‡³å°‘å‹¾ä¸€å€‹é¡å‹
      if (step.dataset.step === "3") {
        const checked = step.querySelectorAll('input[name="types"]:checked');
        if (!checked.length) {
          alert("è‡³å°‘å‹¾é¸ä¸€ç¨®åˆ®åˆ®æ¨‚ï¼Œæ‰å¥½å¹«ä½ ç®—æˆ°ç¸¾ï¼");
          return;
        }
      }
      showStep(idx + 2);
    });
  });

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const formData = new FormData(form);
    const age = formData.get("age");
    const city = formData.get("city");
    const types = formData.getAll("types").join(", ");
    const spent = Number(formData.get("spent") || 0);
    const won = Number(formData.get("won") || 0);

    const net = won - spent;
    const roi = spent > 0 ? (net / spent) * 100 : 0;

    let percentile;
    if (spent === 0) {
      percentile = 50;
    } else if (roi >= 50) {
      percentile = 95;
    } else if (roi >= 0) {
      percentile = 75;
    } else if (roi > -50) {
      percentile = 45;
    } else {
      percentile = 25;
    }

    const randomTitle = TITLES[Math.floor(Math.random() * TITLES.length)];

    const title = net >= 0 ? "æ­å–œï¼Œä½ æ˜¯é€™æ³¢çš„è²¡ç¥ä¹‹ä¸€ï¼" : "è¾›è‹¦äº†ï¼Œä½ æ­£å¼æˆç‚ºå°å½©ç„¡åè‚¡æ±ã€‚";
    const main = `é€™æ¬¡ä½ ç¸½å…± ${spent.toLocaleString()} å…ƒåˆ®åˆ®æ¨‚ï¼Œæœ€å¾Œ${net >= 0 ? "å°è³º" : "å°è³ "} ${Math.abs(net).toLocaleString()} å…ƒï¼ˆæŠ•å ±ç‡ç´„ ${roi.toFixed(1)}%ï¼‰`;
    const compare = `ä¾ç…§ç›®å‰çš„æ¨¡æ“¬åˆ†ä½ˆï¼Œä½ å¤§ç´„è´éç´„ ${percentile}% çš„åƒèˆ‡è€…ã€‚`;

    let banner;
    if (net > 0) {
      banner = "ä»Šå¹´è²¡ç¥æœ‰çœ·é¡§ä½ ï¼Œä½†é‚„æ˜¯è¨˜å¾—ï¼šä¸è¦æ‹¿ç”Ÿæ´»è²»è·Ÿåˆ®åˆ®æ¨‚ç¡¬ç¢°ç¡¬ã€‚";
    } else if (net === 0) {
      banner = "å¹³æ‰‹éå¹´ï¼Œç­‰æ–¼è²·äº†ä¸€æ•´å¥—å…¨å®¶å¨›æ¨‚ï¼Œé‚„è¡Œã€‚";
    } else if (roi < -50) {
      banner = "ä½ æ˜¯å°å½© Q4 çš„é‡è¦è²¢ç»è€…ï¼Œå»ºè­°æ˜å¹´æ”¹æˆæŠŠé€™ç­†éŒ¢ä¸Ÿé€²æŒ‡æ•¸åŒ–æŠ•è³‡ã€‚";
    } else {
      banner = "å°è³ é‚„åœ¨å®‰å…¨ç¯„åœå…§ï¼Œæ˜å¹´å¯ä»¥å…ˆè¨­å®šå¥½é ç®—ï¼Œä¸Šé™åˆ°äº†å°±æ”¶æ‰‹ã€‚";
    }

    // å•å·çµæœç•«é¢ï¼šåªä¿ç•™çµæœï¼Œä¸å†é¡¯ç¤ºé¡Œç›®
    surveySection.style.display = "none";
    resultCard.innerHTML = `
      <div class="result-title">${title}</div>
      <div class="result-main">æœ¬æ¬¡ç³»çµ±é ’çµ¦ä½ çš„é¦¬å¹´ç¨±è™Ÿæ˜¯ï¼š<strong>${randomTitle}</strong></div>
      <div class="result-main">${main}</div>
      <div class="result-detail">èƒŒæ™¯è³‡æ–™ï¼š${age}ã€åœ¨ ${city} éå¹´${types ? `ï¼Œæœ‰è²·ï¼š${types}` : ""}ã€‚</div>
      <div class="result-detail">${compare}</div>
      <div class="result-banner">${banner}</div>
    `;

    const payload = {
      timestamp: new Date().toISOString(),
      age,
      city,
      types,
      spent,
      won,
      net,
      roi,
      nickname: randomTitle,
    };

    try {
      await fetch(SHEET_ENDPOINT, {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload),
      });
    } catch (err) {
      console.warn("å¯«å…¥ Google Sheets å¤±æ•—ï¼ˆå…ˆä¸å½±éŸ¿é«”é©—ï¼‰", err);
    }
  });

  showStep(1);
</script>
</body>
</html>
