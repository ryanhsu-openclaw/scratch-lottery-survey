<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <title>éå¹´åˆ®åˆ®æ¨‚æˆ°ç¸¾èª¿æŸ¥ Â· æ–°å¹´è²¡é‹å„€è¡¨æ¿</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --bg: #0f172a;
      --panel: #020617;
      --border: #1e293b;
      --accent: #f97316;
      --accent-soft: rgba(248,113,113,.15);
      --text: #e5e7eb;
      --muted: #9ca3af;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1f2937 0, #020617 55%);
      color: var(--text);
    }
    .wrap {
      max-width: 960px;
      margin: 0 auto;
      padding: 16px 14px 40px;
    }
    header {
      text-align: center;
      margin-bottom: 16px;
    }
    h1 {
      margin: 0 0 4px;
      font-size: 24px;
    }
    .subtitle {
      font-size: 14px;
      color: var(--muted);
    }

    .layout {
      display: grid;
      gap: 16px;
      grid-template-columns: minmax(0, 1.2fr) minmax(0, .8fr);
    }
    @media (max-width: 800px) {
      .layout {
        grid-template-columns: 1fr;
      }
    }

    .card {
      background: var(--panel);
      border-radius: 12px;
      border: 1px solid var(--border);
      padding: 14px 16px 16px;
    }
    .card h2 {
      margin: 0 0 8px;
      font-size: 18px;
    }
    label {
      display: block;
      margin: 10px 0 4px;
      font-size: 14px;
    }
    select, input[type="number"], input[type="text"] {
      width: 100%;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #334155;
      background: #020617;
      color: var(--text);
      font-size: 14px;
    }
    .checkbox-group {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 4px 12px;
      margin-top: 4px;
    }
    .checkbox-group label {
      margin: 0;
      font-size: 13px;
    }
    .checkbox-group input {
      margin-right: 4px;
    }
    .hint {
      font-size: 12px;
      color: var(--muted);
    }
    button {
      margin-top: 14px;
      width: 100%;
      padding: 10px 12px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(90deg, #f97316, #facc15);
      color: #111827;
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
    }
    button:disabled {
      opacity: .6;
      cursor: wait;
    }

    .result-title {
      font-size: 18px;
      margin-bottom: 6px;
    }
    .result-main {
      font-size: 16px;
      margin-bottom: 4px;
    }
    .result-detail {
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 6px;
    }
    .result-banner {
      margin-top: 10px;
      padding: 8px 10px;
      border-radius: 10px;
      background: var(--accent-soft);
      border: 1px solid rgba(248,113,113,.4);
      font-size: 14px;
    }

    .footer-note {
      margin-top: 10px;
      font-size: 12px;
      color: var(--muted);
    }
  </style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>ğŸ¯ éå¹´åˆ®åˆ®æ¨‚æˆ°ç¸¾èª¿æŸ¥</h1>
    <div class="subtitle">èªªå¯¦è©±ï¼šä½ æ˜¯ã€Œè³€æ­²è²¡ç¥ã€ï¼Œé‚„æ˜¯é»˜é»˜æ‰›èµ·å°å½©ç‡Ÿæ”¶çš„ä¸€ä»½å­ï¼Ÿ</div>
  </header>

  <div class="layout">
    <section class="card">
      <h2>å¡«å¯«ä½ çš„éå¹´åˆ®åˆ®æ¨‚æˆ°å ±</h2>
      <form id="survey-form">
        <label for="age">ä½ å¹¾æ­²ï¼Ÿ</label>
        <select id="age" name="age" required>
          <option value="" disabled selected>è«‹é¸æ“‡å¹´é½¡å€é–“</option>
          <option>æœªæ»¿ 18 æ­²ï¼ˆå°è³­æ€¡æƒ…ï¼Œæ›´è¦ç¯€åˆ¶ï¼‰</option>
          <option>18â€“24 æ­²</option>
          <option>25â€“34 æ­²</option>
          <option>35â€“44 æ­²</option>
          <option>45â€“54 æ­²</option>
          <option>55â€“64 æ­²</option>
          <option>65 æ­²ä»¥ä¸Š</option>
        </select>

        <label for="city">åœ¨å“ªè£¡éå¹´ï¼Ÿ</label>
        <select id="city" name="city" required>
          <option value="" disabled selected>è«‹é¸æ“‡ç¸£å¸‚</option>
          <option>å°åŒ—å¸‚</option><option>æ–°åŒ—å¸‚</option><option>åŸºéš†å¸‚</option>
          <option>æ¡ƒåœ’å¸‚</option><option>æ–°ç«¹å¸‚</option><option>æ–°ç«¹ç¸£</option>
          <option>è‹—æ —ç¸£</option><option>å°ä¸­å¸‚</option><option>å½°åŒ–ç¸£</option>
          <option>å—æŠ•ç¸£</option><option>é›²æ—ç¸£</option><option>å˜‰ç¾©å¸‚</option><option>å˜‰ç¾©ç¸£</option>
          <option>å°å—å¸‚</option><option>é«˜é›„å¸‚</option><option>å±æ±ç¸£</option>
          <option>å®œè˜­ç¸£</option><option>èŠ±è“®ç¸£</option><option>å°æ±ç¸£</option>
          <option>æ¾æ¹–ç¸£</option><option>é‡‘é–€ç¸£</option><option>é€£æ±Ÿç¸£</option>
        </select>

        <label>ä½ ä»Šå¹´éƒ½è²·äº†å“ªäº›åˆ®åˆ®æ¨‚ï¼Ÿï¼ˆå¯è¤‡é¸ï¼‰</label>
        <div class="checkbox-group">
          <label><input type="checkbox" name="types" value="100 å…ƒå°è©¦æ‰‹æ°£">100 å…ƒå°è©¦æ‰‹æ°£</label>
          <label><input type="checkbox" name="types" value="200 å…ƒç¶“å…¸æ¬¾">200 å…ƒç¶“å…¸æ¬¾</label>
          <label><input type="checkbox" name="types" value="500 å…ƒå¤§ç´…åŒ…">500 å…ƒå¤§ç´…åŒ…</label>
          <label><input type="checkbox" name="types" value="1000 å…ƒè¶…ç´šç´…åŒ…">1000 å…ƒè¶…ç´šç´…åŒ…</label>
          <label><input type="checkbox" name="types" value="3000 å…ƒé ‚ç´šè±ªè¯">3000 å…ƒé ‚ç´šè±ªè¯</label>
          <label><input type="checkbox" name="types" value="å…¶ä»–">å…¶ä»– / æƒ³ä¸å‡ºåå­—çš„ç¥ç§˜æ¬¾</label>
        </div>
        <div class="hint">ï¼ˆé¡å‹ä¹‹å¾Œå¯ä»¥å†ä¾å°å½©å®˜æ–¹å“é …å¾®èª¿ï¼‰</div>

        <label for="spent">ç¸½å…±è²·äº†å¤šå°‘éŒ¢çš„åˆ®åˆ®æ¨‚ï¼Ÿï¼ˆå…ƒï¼‰</label>
        <input id="spent" name="spent" type="number" inputmode="decimal" min="0" step="1" required>
        <div class="hint">è«‹å¡«å…¥æ•´æ•¸ï¼Œä¾‹å¦‚ 2000ã€‚</div>

        <label for="won">æœ€å¾Œè´äº†å¤šå°‘éŒ¢ï¼Ÿï¼ˆå¯å¡«è² å€¼ï¼Œè² ä»£è¡¨è³ éŒ¢ï¼‰</label>
        <input id="won" name="won" type="number" inputmode="decimal" step="1" required>
        <div class="hint">ä¾‹å¦‚ï¼šè´ 5000 å°±å¡« 5000ï¼›æ•´é«”å°è³  800 å°±å¡« -800ã€‚</div>

        <label for="nickname">çµ¦è‡ªå·±å–ä¸€å€‹åˆ®åˆ®æ¨‚ç¨±è™Ÿï¼ˆå¯é¸å¡«ï¼‰</label>
        <input id="nickname" name="nickname" type="text" placeholder="ä¾‹å¦‚ï¼šä¸­çåªæœƒå›æœ¬ä»”ã€åˆ®åˆ°æ‰‹è»Ÿå»æ²’ä¸­â€¦">

        <button type="submit">é€å‡ºæˆ°å ±ï¼Œçœ‹çœ‹æˆ‘æ˜¯è²¡ç¥é‚„æ˜¯è´ŠåŠ©å•†</button>
      </form>
      <div class="footer-note">ï¼Šè³‡æ–™æœƒåŒ¿åå¯«å…¥ Google Sheets åšçµ±è¨ˆä½¿ç”¨ï¼Œä¸æœƒæ”¶é›†è¯çµ¡æ–¹å¼ã€‚</div>
    </section>

    <section class="card" id="result-card">
      <div class="result-title">ç­‰ä½ é€å‡ºè¡¨å–®ï¼Œæˆ‘å¹«ä½ ç®—å‘½ã€‚</div>
      <div class="result-detail">æœƒé¡¯ç¤ºï¼šä½ é€™æ¬¡éå¹´åˆ®åˆ®æ¨‚çš„æŠ•å ±ç‡ã€è³ºè³ é‡‘é¡ï¼Œé‚„æœ‰å¤§ç´„è´éå¤šå°‘æ¯”ä¾‹çš„ä½¿ç”¨è€…ã€‚</div>
      <div class="result-banner">ç›®å‰æ¯”è¼ƒæ˜¯ã€Œå…ˆåšå‡ºé«”é©—ã€ï¼Œå¯¦éš›èˆ‡å…¶ä»–äººçš„æ¯”è¼ƒä¹‹å¾Œå¯ä»¥æ¥ Google Sheets çµ±è¨ˆå†èª¿æ•´ã€‚</div>
    </section>
  </div>
</div>

<script>
  // TODO: æ›æˆä½ è‡ªå·±çš„ Google Apps Script / API endpoint
  const SHEET_ENDPOINT = "https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec";

  const form = document.getElementById("survey-form");
  const resultCard = document.getElementById("result-card");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const formData = new FormData(form);
    const age = formData.get("age");
    const city = formData.get("city");
    const types = formData.getAll("types").join(", ");
    const spent = Number(formData.get("spent") || 0);
    const won = Number(formData.get("won") || 0);
    const nickname = formData.get("nickname")?.trim();

    const net = won - spent;
    const roi = spent > 0 ? (net / spent) * 100 : 0;

    // ç²—ç•¥æ¨¡æ“¬ä¸€å€‹ã€Œè´éå¤šå°‘äººã€çš„ç™¾åˆ†ä½ï¼ˆä¹‹å¾Œå¯ä»¥æ”¹ç”¨çœŸæ­£çµ±è¨ˆï¼‰
    let percentile;
    if (spent === 0) {
      percentile = 50;
    } else if (roi >= 50) {
      percentile = 95;
    } else if (roi >= 0) {
      percentile = 75;
    } else if (roi > -50) {
      percentile = 45;
    } else {
      percentile = 25;
    }

    const title = net >= 0 ? "æ­å–œï¼Œä½ æ˜¯é€™æ³¢çš„è²¡ç¥ä¹‹ä¸€ï¼" : "è¾›è‹¦äº†ï¼Œä½ æ­£å¼æˆç‚ºå°å½©ç„¡åè‚¡æ±ã€‚";
    const main = `é€™æ¬¡ä½ ç¸½å…± ${spent.toLocaleString()} å…ƒåˆ®åˆ®æ¨‚ï¼Œæœ€å¾Œ${net >= 0 ? "å°è³º" : "å°è³ "} ${Math.abs(net).toLocaleString()} å…ƒï¼ˆæŠ•å ±ç‡ç´„ ${roi.toFixed(1)}%ï¼‰`;
    const compare = `ä¾ç…§ç›®å‰çš„æ¨¡æ“¬åˆ†ä½ˆï¼Œä½ å¤§ç´„è´éç´„ ${percentile}% çš„åƒèˆ‡è€…ã€‚`; 

    let banner;
    if (net > 0) {
      banner = "ä»Šå¹´è²¡ç¥æœ‰çœ·é¡§ä½ ï¼Œä½†é‚„æ˜¯è¨˜å¾—ï¼šä¸è¦æ‹¿ç”Ÿæ´»è²»è·Ÿåˆ®åˆ®æ¨‚ç¡¬ç¢°ç¡¬ã€‚";
    } else if (net === 0) {
      banner = "å¹³æ‰‹éå¹´ï¼Œç­‰æ–¼è²·äº†ä¸€æ•´å¥—å…¨å®¶å¨›æ¨‚ï¼Œé‚„è¡Œã€‚";
    } else if (roi < -50) {
      banner = "ä½ æ˜¯å°å½© Q4 çš„é‡è¦è²¢ç»è€…ï¼Œå»ºè­°æ˜å¹´æ”¹æˆæŠŠé€™ç­†éŒ¢ä¸Ÿé€²æŒ‡æ•¸åŒ–æŠ•è³‡ã€‚";
    } else {
      banner = "å°è³ é‚„åœ¨å®‰å…¨ç¯„åœå…§ï¼Œæ˜å¹´å¯ä»¥å…ˆè¨­å®šå¥½é ç®—ï¼Œä¸Šé™åˆ°äº†å°±æ”¶æ‰‹ã€‚";
    }

    resultCard.innerHTML = `
      <div class="result-title">${title}</div>
      <div class="result-main">${main}</div>
      <div class="result-detail">ä½ å¡«å¯«çš„èƒŒæ™¯ï¼š${age}ã€åœ¨ ${city} éå¹´${types ? `ï¼Œæœ‰è²·ï¼š${types}` : ""}ã€‚</div>
      <div class="result-detail">${compare}</div>
      <div class="result-banner">${banner}</div>
    `;

    // å˜—è©¦æŠŠè³‡æ–™é€åˆ° Google Sheetsï¼ˆéå¿…è¦ï¼Œå¤±æ•—ä¹Ÿä¸å½±éŸ¿çµæœé¡¯ç¤ºï¼‰
    const payload = {
      timestamp: new Date().toISOString(),
      age,
      city,
      types,
      spent,
      won,
      net,
      roi,
      nickname,
    };

    try {
      await fetch(SHEET_ENDPOINT, {
        method: "POST",
        mode: "no-cors", // Apps Script å¸¸ç”¨
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload),
      });
    } catch (err) {
      console.warn("å¯«å…¥ Google Sheets å¤±æ•—ï¼ˆå…ˆä¸å½±éŸ¿é«”é©—ï¼‰", err);
    }
  });
</script>
</body>
</html>
